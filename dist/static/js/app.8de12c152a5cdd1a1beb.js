webpackJsonp([1],{NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("7+uW"),s=n("Gu7T"),i=n.n(s),r=n("d7EF"),a=n.n(r);function u(){for(var e=0,t=0;t<arguments.length;t++)e+=arguments[t]||0;return e/arguments.length}function c(e){var t=e.clientX,n=e.clientY;e.touches&&e.touches.length&&(t=e.touches[0].clientX,n=e.touches[0].clientY);var o=e.target.getBoundingClientRect();return[t-o.left,n-o.top]}var l={name:"App",data:function(){return{result:"",loading:!0,modelLoadingProgress:0}},created:function(){var e=this;this.model=new window.KerasJS.Model({filepath:"/vue-keras-mnist/dist/static/mnist_cnn.bin",gpu:!0,transferLayerOutputs:!0}),this.model.ready().then(function(){console.log("keras init"),e.loading=!1})},methods:{onMouseDown:function(e){e.preventDefault(),this.drawLine.apply(this,i()(c(e))),this.listenMouseMove=!0},onMouseMove:function(e){e.preventDefault(),console.log("onMouseMove"),this.listenMouseMove&&this.drawLine.apply(this,i()(c(e)))},drawEnd:function(){this.listenMouseMove&&(this.listenMouseMove=!1,delete this.previousX,delete this.previousY,this.predict())},drawLine:function(e,t){var n=this.$refs.canvas.getContext("2d");n.lineWidth=10,n.lineJoin=n.lineCap="round",n.strokeStyle="#393E46",n.beginPath();var o=this.previousX,s=this.previousY;void 0!==o?n.moveTo(o,s):n.moveTo(e,t),n.lineTo(e,t),n.stroke(),this.previousX=e,this.previousY=t},predict:function(){var e=this,t=function(e){for(var t=[],n=0;n<e.length;n+=4){var o=e.slice(n,n+3),s=a()(o,3),i=s[0],r=s[1],c=s[2];t.push((299*i+587*r+114*c)/1e3)}for(var l=[],v=0;v<28;v++)for(var d=0;d<28;d++){for(var h=[],p=10*d;p<10*(d+1);p++)for(var f=10*v;f<10*(v+1);f++)h.push(g(p,f));l.push(u.apply(void 0,h))}function g(e,n){return t[e+280*n]}return l}(this.$refs.canvas.getContext("2d").getImageData(0,0,280,280).data),n={input:new Float32Array(t)};this.model.predict(n).then(function(t){var n=t.output.reduce(function(e,t){return Math.max(e,t)},0);console.log(t.output.indexOf(n)),e.result=t.output.indexOf(n)})},clear:function(){this.$refs.canvas.getContext("2d").clearRect(0,0,280,280),this.result=""}}},v={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"canvas-container"},[n("canvas",{ref:"canvas",attrs:{width:"280",height:"280"},on:{mousedown:e.onMouseDown,mousemove:e.onMouseMove,mouseup:e.drawEnd,mouseleave:e.drawEnd,touchstart:e.onMouseDown,touchmove:e.onMouseMove,touchend:e.drawEnd}})]),e._v(" "),n("div",{staticClass:"clear",on:{click:e.clear}},[e._v("clear")]),e._v(" "),n("p",{staticClass:"result"},[e._v("Resultï¼š"+e._s(e.result))])])},staticRenderFns:[]};var d=n("VU/8")(l,v,!1,function(e){n("y3tI")},null,null).exports;o.a.config.productionTip=!1,new o.a({el:"#app",components:{App:d},template:"<App/>"})},y3tI:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.8de12c152a5cdd1a1beb.js.map